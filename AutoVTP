import os
import paramiko
import time

username = "xxx"
password = "xxx"

if input("are you sure? (y/n)") != "y":
      exit()
      
ssh_client = paramiko.SSHClient()
ssh_client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
# NEVER TOUCH PORT 1 OR 49 <--------------------
# Connect to each IP in your file
# The Path should be to a .txt file that has all cisco equipment IP's w/SSH

Filepath = r"C:\Users\REPAIRMAN\Desktop\SwitchIP.txt"

with open(Filepath)as ip_file:
    line = ip_file.readline()
    cnt = 1
    while line:
        print("Line {}: {}".format(cnt, line.strip()))
        line = ip_file.readline()
        cnt += 1
    for ip_address in ip_file:
          ssh_client.connect(hostname=ip_address,username=username,password=password)

          print ("Successful connection", ip_address)
          remote_connection = ssh_client.invoke_shell()
          time.sleep(2)
          remote_connection.send("enable\n")
          time.sleep(2)
          remote_connection.send("ENABLE_PASS\n")
          time.sleep(2)
          remote_connection.send("conf t\n")
          time.sleep(2)
          remote_connection.send("vtp mode client\n")
          time.sleep(2)
          remote_connection.send("vtp domain VTP_DOMAIN\n")
          time.sleep(2)
          remote_connection.send("vtp password VTP_PASS\n")
          time.sleep(2)
          remote_connection.send("exit\n")
          time.sleep(2)
          remote_connection.send("wr\n")
          time.sleep(7)
          output = remote_connection.recv(65535)          
          Format = output.decode(encoding='UTF-8')
          print(Format)
          print ("Config Edited Successfully")
          ssh_client.close
